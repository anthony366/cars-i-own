<cars-global-navigation sticky-header="true" role="banner">
    <div class="global-nav">
        <div class="container">
<!-- Logo -->
            <a href class="global-nav__logo">
                <img src="http://om.cars.com/dpl/html/om-img/cars-logo.svg" alt="Cars.com logo">
            </a>

<!-- Favorites Trigger -->
            <div class="global-nav__favorite-trigger" id="fav">
                <cui-icon class="global-nav__icon global-nav__icon--favorite">
                    <svg class="icon-heart">
                        <use xlink:href="#icon-heart">
                    </svg>
                    <span class="global-nav__favorite-count">9</span>
                </cui-icon>
            </div>

<!-- Settings Trigger -->
            <div class="global-nav__settings-trigger">
                <cui-icon class="global-nav__icon global-nav__icon--settings">
                    <svg class="icon-settings">
                        <use xlink:href="#icon-settings">
                    </svg>
                </cui-icon>
            </div>

<!-- Menu Trigger -->
            <div class="global-nav__menu-trigger js-menu">
                <span></span>
            </div>

<!-- Menu -->
            <ul class="global-nav__menu">
                <li class="global-nav__option-parent option-parent--buy">
                    <a href>Buy
                        <cui-icon class="global-nav__cta">
                            <svg class="icon-chevron">
                                <use xlink:href="#icon-chevron">
                            </svg>
                        </cui-icon>
                    </a>
                    <div class="global-nav__sub-nav">
                        <a href class="global-nav__close">
                            <cui-icon>
                                <svg class="icon-close">
                                    <use xlink:href="#icon-close">
                                </svg>
                            </cui-icon>
                        </a>
                        <ul>
                            <li><a href>Find Cars for Sale</a></li>
                            <li><a href>Research Car Models</a></li>
                            <li><a href>Review a Car</a></li>
                            <li><a href>Find a Dealer</a></li>
                            <li class="break"><a href>Review a Dealership</a></li>
                            <li><a href>Find Used Car Values</a></li>
                            <li><a href>Estimate Your Payments</a></li>
                            <li><a href>Get Car Buying Advice</a></li>
                        </ul>
                    </div>
                </li>
                <li class="global-nav__option-parent option-parent--sell">
                    <a href>Sell &amp; Trade
                        <cui-icon class="global-nav__cta">
                            <svg class="icon-chevron">
                                <use xlink:href="#icon-chevron">
                            </svg>
                        </cui-icon>
                    </a>
                    <div class="global-nav__sub-nav">
                        <a href class="global-nav__close">
                            <cui-icon>
                                <svg class="icon-close">
                                    <use xlink:href="#icon-close">
                                </svg>
                            </cui-icon>
                        </a>
                        <ul>
                            <li><a href>Sell Your Car</a></li>
                            <li><a href>Find Your Car's Value</a></li>
                            <li><a href>How To Sell Your Car</a></li>
                            <li><a href>My Car.com Listings</a></li>
                        </ul>
                    </div>
                </li>
                <li class="global-nav__option-parent option-parent--service">
                    <a href>Service &amp; Repair
                        <cui-icon class="global-nav__cta">
                            <svg class="icon-chevron">
                                <use xlink:href="#icon-chevron">
                            </svg>
                        </cui-icon>
                    </a>
                    <div class="global-nav__sub-nav">
                        <a href class="global-nav__close">
                            <cui-icon>
                                <svg class="icon-close">
                                    <use xlink:href="#icon-close">
                                </svg>
                            </cui-icon>
                        </a>
                        <ul>
                            <li><a href>Get a Service Estimate</a></li>
                            <li class="break"><a href>Find a Service Center</a></li>
                            <li><a href>Service &amp; Repair Advice</a></li>
                            <li><a href>Safety &amp; Recall Notices</a></li>
                            <li><a href>Car Maintenance 101</a></li>
                        </ul>
                    </div>
                </li>
                <li class="global-nav__option-parent option-parent--news">
                    <a href>News
                        <cui-icon class="global-nav__cta">
                            <svg class="icon-chevron">
                                <use xlink:href="#icon-chevron">
                            </svg>
                        </cui-icon>
                    </a>
                    <div class="global-nav__sub-nav">
                        <a href class="global-nav__close">
                            <cui-icon>
                                <svg class="icon-close">
                                    <use xlink:href="#icon-close">
                                </svg>
                            </cui-icon>
                        </a>
                        <ul>
                            <li><a href>Latest Car News</a></li>
                            <li><a href>Latest Car Reviews</a></li>
                            <li class="break"><a href>Latest Videos</a></li>
                            <li><a href>Awards</a></li>
                            <li><a href>Multi-Car Comparisons</a></li>
                            <li><a href>Updates &amp; Trends</a></li>
                            <li><a href>Help for First-Time Buyers</a></li>
                            <li class="break"><a href>Child Car Seat Checks</a></li>
                            <li><a href>Detroit Auto Show</a></li>
                            <li><a href>Chicago Auto Show</a></li>
                            <li><a href>New York Auto Show</a></li>
                            <li><a href>LA Auto Show</a></li>
                        </ul>
                    </div>
                </li>
                <li class="global-nav__option-parent option-parent--feedback">
                    <a href>[+] Feedback
                        <cui-icon class="global-nav__cta">
                            <svg class="icon-chevron">
                                <use xlink:href="#icon-chevron">
                            </svg>
                        </cui-icon>
                    </a>
                </li>
            </ul>

<!-- Settings menu -->
            <div class="global-nav__extra global-nav__settings">
                <a href class="global-nav__close">
                    <cui-icon>
                        <svg class="icon-close">
                            <use xlink:href="#icon-close">
                        </svg>
                    </cui-icon>
                </a>
                <div class="global-nav__sub-menu">
                    <p class="cui-epsilon extra-menu__heading">Welcome <b class="loggedin">back, bradbice@gmail.com </b><b class="loggedout">to Cars.com</b>!</p>
                    <p class="extra-menu__desc"><b class="loggedout">Sign up or log in to access your favorite cars and saved searches on other devices.</b><b class="loggedin">Visit Account Settings to change your email address or name.<br>
                    Use your login on other devices to access your favorite cars and saved searches.</b></p>
                    <ul class="extra-menu__sub-nav">
                        <li class="settings-menu__signup"><a href><b class="loggedout">Sign Up</b><b class="loggedin">Account Settings</b></a></li>
                        <li class="settings-menu__login loginout">
                            <a href>
                                <small class="loggedout">Already have an account?</small>
                                Log <b class="loggedout">In</b><b class="loggedin">Out</b>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>

<!-- Favorites menu -->
            <div class="global-nav__extra global-nav__favorite">
                <a href class="global-nav__close">
                    <cui-icon>
                        <svg class="icon-close">
                            <use xlink:href="#icon-close">
                        </svg>
                    </cui-icon>
                </a>
                <div class="global-nav__sub-menu">
                    <p class="cui-epsilon extra-menu__heading">Welcome to Cars.com</p>
                    <p class="extra-menu__desc"><b class="loggedout"><a href>Sign Up</a> or <a href>Log In</a> to view your favorite cars and saved searches on other devices.</b><b class="loggedin">Use your login on other devices to see your favorite cars and saved searches.</b></p>
                    <ul class="extra-menu__sub-nav">
                        <li><a href>Favorite Cars (7)</a></li>
                        <li><a href>Saved Searches (3)</a></li>
                        <li class="favorite-menu__signup"><a href><b class="loggedout">Sign Up</b><b class="loggedin">Account Settings</b></a></li>
                        <li class="favorite-menu__login"><a href class="loginout">Log <b class="loggedout">In</b><b class="loggedin">Out</b></a></li>
                    </ul>
                </div>
            </div>

        </div>
    </div>

</cars-global-navigation>

<script>

$('html').click(function() {
    $(".js-menu, .global-nav__option-parent, .global-nav__settings-trigger, .global-nav__favorite-trigger, .global-nav__favorite, .global-nav__settings").removeClass("active");
    $(".global-nav__settings, .global-nav__favorite").css("display", "none");
    $(".page").removeClass("noscroll");
});

$('cars-global-navigation').click(function(e) {
    e.stopPropagation();
});

// Menu
$(".js-menu").on("click", function(e) {
    e.stopPropagation();
    $(this).toggleClass("active");
    $(".global-nav__favorite-trigger").removeClass("active");
    $(".global-nav__favorite").css("display", "none");
    $(".page").toggleClass("noscroll");
    $(".global-nav__menu").toggle();
});

// Sub-menus
$(".global-nav__option-parent > a").on("click", function(e) {
    $(this).parent("li").siblings("li").removeClass("active");
    $(".global-nav__settings, .global-nav__favorite").css("display", "none");
    $(".global-nav__favorite, .global-nav__settings, .global-nav__settings-trigger, .global-nav__favorite-trigger").removeClass("active");
    $(".page").toggleClass("noscroll");
    $(this).parent().toggleClass("active");
    e.preventDefault();
    // TODO: Display via JS, not CSS
});

// Settings menu
$(".global-nav__settings-trigger").on("click", function(e) {
    e.stopPropagation();
    $(".global-nav__option-parent").removeClass("active");
    $(this).siblings(".global-nav__favorite-trigger").removeClass("active");
    $(".global-nav__menu-trigger, .global-nav__favorite").removeClass("active");
    $(".global-nav__menu, .global-nav__favorite").css("display", "none");
    $(".page").toggleClass("noscroll");
    $(this).toggleClass("active");
    $(".global-nav__settings").toggleClass("active");
    $(".global-nav__settings").toggle();
});

// Favorites menu
$(".global-nav__favorite-count").on("click", function(e) {
    e.stopPropagation();
    $(".global-nav__option-parent").removeClass("active");
    $(this).parents(".global-nav__favorite-trigger").siblings(".global-nav__settings-trigger").removeClass("active");

    if($(this).parents(".global-nav__favorite-trigger").hasClass('active')) {
        $(this).parents(".global-nav__favorite-trigger").removeClass('active');
        $(this).parents(".global-nav__favorite-trigger").addClass('hearty');
    } else {
        $(this).parents(".global-nav__favorite-trigger").removeClass('hearty');
        $(this).parents(".global-nav__favorite-trigger").addClass('active');
    }

    // $(this).siblings("svg").style.webkitAnimationPlayState = "running";
    // $(this).siblings("svg").on('webkitAnimationEnd', function() {
    // this.style.webkitAnimationPlayState = "paused";
    // });

    $(".global-nav__icon--favorite").toggleClass("heart");
    $(".global-nav__menu-trigger, global-nav__settings-trigger, .global-nav__settings").removeClass("active");
    $(".global-nav__settings, .global-nav__menu").css("display", "none");
    $(".page").toggleClass("noscroll");
    $(".global-nav__favorite").toggleClass("active");
    $(".global-nav__favorite").toggle();
    // retrieve the element

});

// Sub-nav close
$(".global-nav__close").on("click", function(e) {
    e.stopPropagation();
    $(".page").toggleClass("noscroll");
    $(this).parents(".global-nav__option-parent").removeClass("active");
});

$(".global-nav__extra .global-nav__close").on("click", function(e) {
    e.stopPropagation();
    $(".page").toggleClass("noscroll");
    $(this).parents(".global-nav__extra").removeClass("active");
    $(this).parents(".global-nav__extra").css("display", "none");
    $(".global-nav__settings-trigger, .global-nav__favorite-trigger").removeClass("active");
});

// Log in/out
$(".loginout").on("click", function(e) {
    e.stopPropagation();
    $("body").toggleClass("logged-out logged-in");
});

function removesubnav(){
    setTimeout(function(){
        $(".global-nav__favorite-trigger, .global-nav__settings-trigger, .global-nav__option-parent").removeClass("active");
    });
}


// Sticky scroll header
$(document).scroll(function() {
    removesubnav();
    if ($(document).scrollTop() > 100) {
        $('.global-nav__logo').addClass("sticky");
    }
    if ($(document).scrollTop() < 100) {
        $('.global-nav__logo').removeClass("sticky");
    }
});

var lastScrollTop = 0;
var headerstatus = 1;
$(window).scroll(function() {
    var st = $(window).scrollTop();
    if ((st > 60) && (st > lastScrollTop)) {
        $(".global-nav").css({
            "top": "-48px"
        });
        $("body").removeClass("menuYes").addClass("menuNo");
    } else {
        $(".global-nav").css({
            "top": "0px"
        });
        $("body").removeClass("menuNo").addClass("menuYes");
    }
    // if((st > 200)) {
    //     $(".mmy-menu.isStuck").css({
    //         "top": "4.8rem"
    //     });
    // }
    lastScrollTop = st;
});

</script>
